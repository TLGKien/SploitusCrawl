import requests
import shodan
requests.packages.urllib3.disable_warnings()


API_KEY="efcvAyCxStfH2QHitBSY30eW0hb8GVCM"
# Search term with favicon Openfire and country is China
SEARCH_FOR="http.favicon.hash:1211608009 country:\"CN\""

f=open("nuclei-targets.txt","a")


api = shodan.Shodan(API_KEY)
result = api.search(SEARCH_FOR,limit=1000)

# Write to file
for service in result['matches']:
    IP = service['ip_str']
    port = service['port']
    url="http://{}:{}".format(IP,port)
    f.writelines(url+"\n")


